# Hooks Ùˆ Utilities Ù„Ù„Ø±Ø³Ø§Ø¦Ù„

Ù…Ø¬Ù…ÙˆØ¹Ø© Ø´Ø§Ù…Ù„Ø© Ù…Ù† Hooks Ùˆ Utilities Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª.

## ğŸ“‹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

- [Ø§Ù„Ù…ÙŠØ²Ø§Øª](#Ø§Ù„Ù…ÙŠØ²Ø§Øª)
- [Hooks Ø§Ù„Ù…ØªÙˆÙØ±Ø©](#hooks-Ø§Ù„Ù…ØªÙˆÙØ±Ø©)
- [Utilities](#utilities)
- [Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯](#Ø§Ù„ØªØ«Ø¨ÙŠØª-ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯)
- [Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#Ø£Ù…Ø«Ù„Ø©-Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
- [Testing](#testing)
- [Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©](#Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©)

## âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª

### ğŸ“¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
- **Real-time updates** - ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„
- **Pagination & Infinite Scroll** - ØªØµÙØ­ ØµÙØ­Ø§Øª Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠ
- **Search & Filtering** - Ø¨Ø­Ø« ÙˆØªØµÙÙŠØ© Ù…ØªÙ‚Ø¯Ù…
- **Message Operations** - Ø¥Ø±Ø³Ø§Ù„ØŒ ØªØ¹Ø¯ÙŠÙ„ØŒ Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
- **Typing Indicators** - Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©
- **File Attachments** - Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª
- **RTL Text Support** - Ø¯Ø¹Ù… Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©

### ğŸ’¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
- **Conversation Management** - Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
- **Online Status** - Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- **Conversation Status** - Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª (Ù†Ø´Ø·Ø©ØŒ Ù…ØºÙ„Ù‚Ø©ØŒ Ù…ØªÙˆÙ‚ÙØ©)
- **Lead Integration** - Ø±Ø¨Ø· Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ†

### ğŸ“ Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
- **Template CRUD** - Ø¥Ù†Ø´Ø§Ø¡ ÙˆÙ‚Ø±Ø§Ø¡Ø© ÙˆØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
- **Variable Substitution** - Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
- **Template Preview** - Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
- **Category Organization** - ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø¨Ø§Ù„ÙØ¦Ø§Øª

## ğŸª Hooks Ø§Ù„Ù…ØªÙˆÙØ±Ø©

### `useMessages`

Hook Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙØ±Ø¯ÙŠØ© ÙÙŠ Ù…Ø­Ø§Ø¯Ø«Ø©.

```typescript
const {
  messages,                 // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  loading,                 // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  error,                   // Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
  searchQuery,             // Ù†Øµ Ø§Ù„Ø¨Ø­Ø«
  filteredMessages,        // Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
  sendMessage,             // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
  markAsRead,              // ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø©
  deleteMessage,           // Ø­Ø°Ù Ø±Ø³Ø§Ù„Ø©
  subscribeToNewMessages,  // Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  refreshMessages,         // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  validateMessage,         // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©
} = useMessages({
  conversationId: 'conv-123',
  enableRealTime: true,
  autoRefresh: true,
  onNewMessage: (message) => console.log('New message:', message),
});
```

#### Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
- `conversationId` - Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
- `enableRealTime` - ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
- `autoRefresh` - ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ
- `refreshInterval` - ÙØªØ±Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ø§Ù„Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©
- `onNewMessage` - Ø¯Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©

#### Ø§Ù„Ø¯ÙˆØ§Ù„
- `sendMessage(content: string, type: MessageType)` - Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
- `markAsRead(messageId: string)` - ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø©
- `deleteMessage(messageId: string)` - Ø­Ø°Ù Ø±Ø³Ø§Ù„Ø©
- `searchMessages(query: string)` - Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
- `applyFilters(filters: Partial<MessageSearchParams>)` - ØªØ·Ø¨ÙŠÙ‚ ÙÙ„Ø§ØªØ±

### `useConversations`

Hook Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª.

```typescript
const {
  conversations,           // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
  loading,
  error,
  searchQuery,
  filteredConversations,   // Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
  getConversation,         // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¯Ø«Ø©
  updateConversationStatus,// ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
  closeConversation,       // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
  reopenConversation,      // Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
  subscribeToConversations,// Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
  getUnreadConversations,  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
} = useConversations({
  leadId: 'lead-123',
  enableRealTime: true,
  onConversationUpdate: (conversation) => console.log('Updated:', conversation),
});
```

#### Ø§Ù„Ø¯ÙˆØ§Ù„
- `getConversation(conversationId: string)` - Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø±Ø³Ø§Ø¦Ù„Ù‡Ø§
- `updateConversationStatus(id: string, status: ConversationStatus)`
- `closeConversation(conversationId: string)`
- `reopenConversation(conversationId: string)`
- `addConversationNote(conversationId: string, content: string)`

### `useMessageTemplates`

Hook Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„.

```typescript
const {
  templates,               // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
  loading,
  error,
  categories,              // ÙØ¦Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
  searchQuery,
  filteredTemplates,
  createTemplate,          // Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ù„Ø¨
  updateTemplate,          // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ù„Ø¨
  deleteTemplate,          // Ø­Ø°Ù Ù‚Ø§Ù„Ø¨
  duplicateTemplate,       // Ù†Ø³Ø® Ù‚Ø§Ù„Ø¨
  renderTemplate,          // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
  getTemplatePreview,      // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨
  validateTemplateVariables, // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
} = useMessageTemplates({
  category: 'Welcome',
  enableSearch: true,
  onTemplateCreate: (template) => console.log('Created:', template),
});
```

#### Ø¯ÙˆØ§Ù„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
- `createTemplate(data: CreateMessageTemplateRequest)`
- `updateTemplate(id: string, data: UpdateMessageTemplateRequest)`
- `deleteTemplate(id: string)`
- `duplicateTemplate(id: string)`
- `renderTemplate(id: string, variables: Record<string, any>)`
- `getTemplatePreview(id: string, sampleVariables?)`

## ğŸ› ï¸ Utilities

### `messageUtils`

Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„.

```typescript
import { messageUtils } from '../lib/message-utils';

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©
const validation = messageUtils.validateMessage({
  type: 'text',
  text: 'Ù…Ø±Ø­Ø¨Ø§!',
  attachments: []
});

if (validation.is_valid) {
  console.log('Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØµØ­ÙŠØ­Ø©');
} else {
  console.log('Ø£Ø®Ø·Ø§Ø¡:', validation.errors);
}

// ØªÙ†Ø³ÙŠÙ‚ ÙˆÙ‚Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø©
const timeFormatted = messageUtils.formatMessageTimestamp('2024-01-01T12:00:00Z', 'ar');
// "Ù…Ù†Ø° 5 Ø¯Ù‚Ø§Ø¦Ù‚" Ø£Ùˆ "Ù¡ ÙŠÙ†Ø§ÙŠØ± Ù¢Ù Ù¢Ù¤ØŒ Ù¡Ù¢:Ù Ù  Ù…"

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰
const variables = messageUtils.extractMessageVariables('Ù…Ø±Ø­Ø¨Ø§Ù‹ {{name}}!');
// ['name']

// Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
const rendered = messageUtils.renderTemplate(template, {
  name: 'Ø£Ø­Ù…Ø¯',
  company: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø¬Ø§Ø­'
});
```

#### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ØªÙˆÙØ±Ø©

**Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Validation**
- `validateMessage(data: any)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `validateSendMessage(data: SendMessageValidation)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `validateTemplateVariables(template, variables)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨

**Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª**
- `formatMessageTimestamp(date, locale)` - ØªÙ†Ø³ÙŠÙ‚ ÙˆÙ‚Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `isMessageRecent(date, threshold)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯Ø§Ø«Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `getMessageDateInfo(date)` - Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø³Ø§Ù„Ø©

**ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰**
- `parseMessageContent(content)` - ØªØ­Ù„ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `extractMessageVariables(content)` - Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
- `detectTextDirection(text)` - Ø§ÙƒØªØ´Ø§Ù Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Øµ

**Ø¯Ø¹Ù… RTL**
- `isArabicText(text)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
- `formatMessageForDisplay(message)` - ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©

**Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª**
- `getFileIcon(mimeType)` - Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
- `formatFileSize(bytes)` - ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù
- `isValidAttachmentFile(file)` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø±ÙÙ‚

**Ø§Ù„ØªÙ†Ø³ÙŠÙ‚**
- `truncateMessage(content, maxLength)` - Ù‚Ø·Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `highlightSearchTerms(content, searchTerm)` - ØªÙ…ÙŠÙŠØ² Ù…ØµØ·Ù„Ø­Ø§Øª Ø§Ù„Ø¨Ø­Ø«

## ğŸ“¦ Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯

### Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
- React 18+
- TypeScript 5+
- @tanstack/react-query 5+
- Zod 3+
- Next.js 14+

### Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯

1. **Ø¥Ø¹Ø¯Ø§Ø¯ QueryClient ÙÙŠ app layout**

```typescript
// app/layout.tsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 2,
      staleTime: 5 * 60 * 1000, // 5 minutes
    },
  },
});

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <QueryClientProvider client={queryClient}>
      {children}
    </QueryClientProvider>
  );
}
```

2. **Ø¥Ø¹Ø¯Ø§Ø¯ WebSocket Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©** (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

```typescript
// lib/websocket.ts
export const initializeWebSocket = () => {
  if (typeof window !== 'undefined') {
    // Ø¥Ø¹Ø¯Ø§Ø¯ WebSocket connection
    const ws = new WebSocket('ws://localhost:8000/ws');
    return ws;
  }
  return null;
};
```

## ğŸ“ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### Ù…Ø«Ø§Ù„ 1: ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©

```typescript
// components/ChatInterface.tsx
import { useMessages } from '../hooks/useMessages';
import { useConversations } from '../hooks/useConversations';

export default function ChatInterface({ conversationId }: { conversationId: string }) {
  const {
    messages,
    loading,
    sendMessage,
    subscribeToNewMessages,
  } = useMessages({
    conversationId,
    enableRealTime: true,
  });

  const [newMessage, setNewMessage] = useState('');

  const handleSend = async () => {
    if (!newMessage.trim()) return;
    
    try {
      await sendMessage(newMessage, 'text');
      setNewMessage('');
    } catch (error) {
      console.error('ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', error);
    }
  };

  useEffect(() => {
    const unsubscribe = subscribeToNewMessages((message) => {
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
      console.log('Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©:', message);
    });

    return unsubscribe;
  }, [subscribeToNewMessages]);

  return (
    <div className="chat-container">
      {loading && <div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>}
      
      <div className="messages-list">
        {messages.map((message) => (
          <MessageBubble key={message.id} message={message} />
        ))}
      </div>

      <div className="message-input">
        <input
          value={newMessage}
          onChange={(e) => setNewMessage(e.target.value)}
          placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..."
        />
        <button onClick={handleSend}>Ø¥Ø±Ø³Ø§Ù„</button>
      </div>
    </div>
  );
}
```

### Ù…Ø«Ø§Ù„ 2: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª

```typescript
// components/ConversationsList.tsx
import { useConversations } from '../hooks/useConversations';

export default function ConversationsList() {
  const {
    conversations,
    loading,
    searchQuery,
    filteredConversations,
    searchConversations,
    getUnreadConversations,
  } = useConversations();

  return (
    <div className="conversations-list">
      <div className="search-bar">
        <input
          value={searchQuery}
          onChange={(e) => searchConversations(e.target.value)}
          placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª..."
        />
      </div>

      {loading && <div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>}

      <div className="conversations">
        {filteredConversations.map((conversation) => (
          <ConversationItem
            key={conversation.id}
            conversation={conversation}
            unread={conversation.message_count > 0}
          />
        ))}
      </div>
    </div>
  );
}
```

### Ù…Ø«Ø§Ù„ 3: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨

```typescript
// components/MessageTemplateSelector.tsx
import { useMessageTemplates } from '../hooks/useMessageTemplates';

export default function MessageTemplateSelector() {
  const {
    templates,
    categories,
    renderTemplate,
    getTemplatePreview,
    validateTemplateVariables,
  } = useMessageTemplates();

  const [selectedTemplate, setSelectedTemplate] = useState<MessageTemplate | null>(null);
  const [variables, setVariables] = useState<Record<string, any>>({});

  const handleTemplateSelect = (template: MessageTemplate) => {
    setSelectedTemplate(template);
    const templateVars = Object.fromEntries(
      template.variables.map(v => [v.name, v.default_value || ''])
    );
    setVariables(templateVars);
  };

  const renderedMessage = selectedTemplate
    ? renderTemplate(selectedTemplate.id, variables)
    : '';

  return (
    <div className="template-selector">
      <div className="categories">
        {categories.map(category => (
          <button key={category}>{category}</button>
        ))}
      </div>

      <div className="templates">
        {templates.map(template => (
          <div
            key={template.id}
            className={`template-item ${selectedTemplate?.id === template.id ? 'selected' : ''}`}
            onClick={() => handleTemplateSelect(template)}
          >
            <h4>{template.name}</h4>
            <p>{template.content.substring(0, 50)}...</p>
          </div>
        ))}
      </div>

      {selectedTemplate && (
        <div className="template-editor">
          <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨</h3>
          <div className="preview">
            {renderedMessage}
          </div>

          <div className="variables">
            {selectedTemplate.variables.map(variable => (
              <div key={variable.name}>
                <label>{variable.label}</label>
                <input
                  type={variable.type}
                  value={variables[variable.name] || ''}
                  onChange={(e) => setVariables(prev => ({
                    ...prev,
                    [variable.name]: e.target.value
                  }))}
                  required={variable.required}
                />
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}
```

## ğŸ§ª Testing

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

```typescript
// __tests__/useMessages.test.tsx
import { renderHook, waitFor } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { useMessages } from '../hooks/useMessages';
import { 
  createTestWrapper, 
  createMockMessage,
  HookTestUtils 
} from '../hooks/test-utils';

describe('useMessages', () => {
  const createWrapper = () => createTestWrapper();

  it('should load messages', async () => {
    const { result } = renderHook(() => useMessages({
      conversationId: 'conv-123'
    }), { 
      wrapper: createWrapper() 
    });

    await waitFor(() => {
      expect(result.current.loading).toBe(false);
    });

    expect(Array.isArray(result.current.messages)).toBe(true);
  });

  it('should send a message', async () => {
    const { result } = renderHook(() => useMessages({
      conversationId: 'conv-123'
    }), { 
      wrapper: createWrapper() 
    });

    await act(async () => {
      await result.current.sendMessage('Hello World', 'text');
    });

    // Verify message was sent
    expect(result.current.messages).toContainEqual(
      expect.objectContaining({ content: 'Hello World' })
    );
  });

  it('should handle real-time updates', async () => {
    const { result } = renderHook(() => useMessages({
      conversationId: 'conv-123'
    }), { 
      wrapper: createWrapper() 
    });

    const mockMessage = createMockMessage({ content: 'Real-time message' });
    
    const unsubscribe = HookTestUtils.emitNewMessage(
      result.current.subscribeToNewMessages,
      mockMessage
    );

    await waitFor(() => {
      expect(result.current.messages).toContainEqual(mockMessage);
    });

    unsubscribe();
  });
});
```

### ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

```bash
npm test
npm run test:coverage
npm run test:watch
```

## ğŸš€ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†

### Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª

1. **Ø§Ø³ØªØ®Ø¯Ø§Ù… React Query** Ù„Ù„caching Ùˆstate management
2. **Debounce Ù„Ù„Ø¨Ø­Ø«** Ù„Ù…Ù†Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©
3. **Pagination** Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
4. **Virtualization** Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø·ÙˆÙŠÙ„Ø©
5. **Real-time subscriptions** Ø¨Ø­Ø°Ø± Ù„ØªØ¬Ù†Ø¨ memory leaks

### ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡

```typescript
// Ø§Ø³ØªØ®Ø¯Ø§Ù… useMemo Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ÙƒÙ„ÙØ©
const filteredMessages = useMemo(() => {
  return messages.filter(message => 
    message.content.toLowerCase().includes(searchQuery.toLowerCase())
  );
}, [messages, searchQuery]);

// Ø§Ø³ØªØ®Ø¯Ø§Ù… useCallback Ù„Ù„Ø¯ÙˆØ§Ù„
const handleSendMessage = useCallback(async (content: string) => {
  await sendMessage(content, 'text');
}, [sendMessage]);

// ØªÙ†Ø¸ÙŠÙ subscriptions
useEffect(() => {
  const unsubscribe = subscribeToNewMessages(handleNewMessage);
  return () => unsubscribe();
}, [subscribeToNewMessages]);
```

## ğŸ¤ Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©

Ù†Ø±Ø­Ø¨ Ø¨Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø§Øª! ÙŠØ±Ø¬Ù‰ Ø§ØªØ¨Ø§Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª:

1. Fork Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
2. Ø¥Ù†Ø´Ø§Ø¡ branch Ø¬Ø¯ÙŠØ¯ (`git checkout -b feature/amazing-feature`)
3. Commit Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª (`git commit -m 'Add amazing feature'`)
4. Push Ù„Ù„branch (`git push origin feature/amazing-feature`)
5. ÙØªØ­ Pull Request

### Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ÙƒÙˆØ¯

- TypeScript Ù„Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
- ESLint Ùˆ Prettier Ù„Ù„ØªÙ†Ø³ÙŠÙ‚
- Testing Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
- Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø±Ø®Øµ ØªØ­Øª Ø±Ø®ØµØ© MIT - Ø§Ù†Ø¸Ø± Ù…Ù„Ù [LICENSE](LICENSE) Ù„Ù„ØªÙØ§ØµÙŠÙ„.

## ğŸ†˜ Ø§Ù„Ø¯Ø¹Ù…

Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ø£Ùˆ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ø£Ø³Ø¦Ù„Ø©:

- ÙØªØ­ issue ÙÙŠ GitHub
- Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚
- Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±

---

**Ù…Ù„Ø§Ø­Ø¸Ø©**: Ù‡Ø°Ø§ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ø¨Ø§Ù†ØªØ¸Ø§Ù…. Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© GitHub repository.